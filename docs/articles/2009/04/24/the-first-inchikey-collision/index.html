<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>The First InChIKey Collision | Depth-First</title>
    <link rel="alternate" href="/articles.atom" title="Depth-First" type="application/atom+xml">
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/global.css">
    <link rel="shortcut icon" href="/images/favicon.png">
    <link rel="me" href="https://fosstodon.org/@rapodaca">
        <link rel="stylesheet" href="/css/document.css">
    <link rel="stylesheet" href="/css/syntax.css">
    <link rel="stylesheet" href="/css/article.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">

  </head>
  <body>
    <header>
      <div class="wrapper">
        <div class="site-id"><a href="/">Depth-First</a></div>
        <nav>
          <ul>
            <li><a href="/articles/">Archive</a></li><li><a href="/about/">About</a></li>
          </ul>
        </nav>
      </div>
    </header>
    <main>
      <div class="wrapper">
            <article>
      <header>
        <h1>The First InChIKey Collision</h1>
        <p class="byline">By Richard L. Apodaca</p>
          <time datetime="2009-04-24T00:00:00.000Z">2009-04-24T00:00:00.000Z</time>
      </header>
      <p>Noel O'Boyle <a href="http://baoilleach.blogspot.com/2009/04/broken-symmetry-can-smiles-and-inchi.html">raises an important question</a> about the canonicalization algorithms used in <a href="/articles/2007/03/14/eleven-qualities-of-the-perfect-line-notation-for-the-web">chemical line notations</a> such as SMILES and InChI:</p>
<blockquote>
  <p>Can their canonicalisation procedures ensure that two identical molecular graphs result in the same canonical SMILES or InChI?</p>
</blockquote>
<p>This isn't merely an academic exercise. One of the best uses for InChI that I've found is as a private primary key in a molecular database. For example, instead of performing a computationally intensive exact <a href="/articles/2008/10/02/fast-substructure-search-using-open-source-tools-part-1-fingerprints-and-databases">structure search</a> to determine if a newly-submitted molecule already exists as part of a <a href="/articles/2009/01/15/build-a-restful-chemical-registration-system-from-scratch-part-1-tools-of-the-trade">chemical registration system</a>, we can simply convert the molecule into a string with InChI and query an indexed field in the 'molecule' table, using code highly-optimized by our database system.</p>
<p>Not only that, but the way InChIs are generated assures us that some of the trickier problems in creating chemical registration systems, such as stereoisomer identification and tautomer detection, have been addressed at virtually no cost.</p>
<p>If there ever were a failure in a line notation canonicalization algorithm, it would probably be detected by a database maintainer noticing that the system failed to register a molecule that clearly wasn't already present, or registered a molecule that already was present.</p>
<p>In other words, this kind of 'bug' might be difficult to detect.</p>
<p>If it's any consolation, <a href="http://pubchem.ncbi.nlm.nih.gov/">PubChem</a> maintains the world's largest collection of <a href="/articles/2006/09/29/hacking-pubchem-direct-access-with-ftp">freely-downloadable</a> InChI-structure correlations (tens of millions), and as far as I know has not encountered a single InChI failure.</p>
<p>Another kind of failure is possible, though highly unlikely, when using InChIKey, which is generated from a <a href="http://en.wikipedia.org/wiki/SHA_hash_functions">cryptograpic hash</a> of the full InChI. From the <a href="http://www.iupac.org/inchi/release102.html">Official InChI site</a>:</p>
<blockquote>
  <p>There is a finite, but very small probability of finding two structures with the same InChIKey. For duplication of only the first block of 14 characters this is 1.3% in 10<sup>9</sup>, equivalent to a single collision in one of 75 databases of 10<sup>9</sup> compounds each. </p>
</blockquote>
<p>Those are pretty slim odds indeed. But they're not zero, either. As far as I know, not one InChI Key collision has been reported to date. But that doesn't mean one won't be found later on today.</p>
<p>If you wanted to create an efficient system for finding InChIKey collisions, how would you go about doing it?</p>
    </article>

      </div>
    </main>
    <footer>
      <ul>
        <li>&copy; 2006-2023<li><a href="https://creativecommons.org/licenses/by/2.0/">CC-BY</a></li><li><a href="/about/">Richard L. Apodaca</a></li><li><a href="/articles.atom">Feed</a></li>
      </ul>
    </footer>
    <script src="/js/moment.js"></script>
    <script src="/js/timestamps.js"></script>
    <script src="/js/analytics.js"></script>
  </body>
</html>