<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Chemical Markup Language and Ferrocene Part 2 - Cyclopentadienyl Anion | Depth-First</title>
    <link rel="alternate" href="/articles.atom" title="Depth-First" type="application/atom+xml">
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/global.css">
    <link rel="shortcut icon" href="/images/favicon.png">
    <link rel="me" href="https://fosstodon.org/@rapodaca">
        <link rel="stylesheet" href="/css/document.css">
    <link rel="stylesheet" href="/css/syntax.css">
    <link rel="stylesheet" href="/css/article.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">

  </head>
  <body>
    <header>
      <div class="wrapper">
        <div class="site-id"><a href="/">Depth-First</a></div>
        <nav>
          <ul>
            <li><a href="/articles/">Archive</a></li><li><a href="/about/">About</a></li>
          </ul>
        </nav>
      </div>
    </header>
    <main>
      <div class="wrapper">
            <article>
      <header>
        <h1>Chemical Markup Language and Ferrocene Part 2 - Cyclopentadienyl Anion</h1>
        <p class="byline">By Richard L. Apodaca</p>
          <time datetime="2009-04-13T00:00:00.000Z">2009-04-13T00:00:00.000Z</time>
      </header>
      <p>The representation of ferrocene is a longstanding problem in cheminformatics. What makes ferrocene a problem is that the deeply entrenched simplification that covalent bonds only ever consist of two atoms sharing a multiple of two electrons simply doesn't apply. When we try to stick with this model anyway, <a href="/articles/2006/12/12/the-problem-with-ferrocene">Bad Things can happen</a>.</p>
<p>This is a problem that deserves attention and vigorous debate. Ferrocenes and other organometallics are no longer novelty items safely tucked away in the recesses of a few organometallics labs - they are stable structural motifs in a variety of useful substances <a href="/articles/2009/03/27/a-comprehensive-guide-flexmol-a-modern-language-for-chemical-representation-part-2-real-world-problems">ranging from catalysts to biological probes</a>. And they're starting to show up in databases and other cheminformatics services with results that range from puzzling to comical.</p>
<h2 id="allarticlesinthisseries">All Articles in this Series</h2>
<ul>
<li><a href="/articles/2009/04/09/chemical-markup-language-and-ferrocene-part-1-chem4word-and-breaking-with-the-past">Chemical Markup Language and Ferrocene Part 1: Chem4Word and Breaking with the Past</a></li>
<li>Chemical Markup Language and Ferrocene Part 2: Cyclopentadienyl Anion</li>
</ul>
<h2 id="ascientificdebate">A Scientific Debate</h2>
<p>Peter Murray-Rust has agreed to take up my challenge to <a href="/articles/2009/04/09/chemical-markup-language-and-ferrocene-part-1-chem4word-and-breaking-with-the-past">demonstrate how Chemical Markup Language (CML) represents ferrocene</a>. In this series of articles, I'll be comparing the CML representations he offers with those available through <a href="/articles/2009/03/19/a-comprehensive-guide-flexmol-a-modern-language-for-chemical-representation-part-1-outlining-the-problem">FlexMol</a> another XML-based molecular language.</p>
<p>The goal is to use a specific problem molecule in cheminformatics as a lense through which the techniques and tradeoffs in both FlexMol and CML can become clear. The lessons should be applicable to those who want to improve CML or FlexMol, or design an entirely different language altogether.</p>
<h2 id="startwithcyclopentadienylanion">Start with Cyclopentadienyl Anion</h2>
<p>If you want to understand ferrocene, it helps to understand cyclopentadienyl anion, one of its component parts. This article will simply compare a CML representation of cyclopentadienyl anion with a FlexMol representation.</p>
<h2 id="cml">CML</h2>
<p>Peter <a href="http://wwmm.ch.cam.ac.uk/blogs/murrayrust/?p=1563">offers the following CML</a> as one approach to representing cyclopentadienyl anion:</p>
<p><img src="/images/posts/20090413/cml.png" alt="CML" title="CML"></p>
<pre><code class="hljs xml language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">molecule</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"m2"</span> <span class="hljs-attr">formalCharge</span>=<span class="hljs-string">"-1"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">atomArray</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"a1"</span> <span class="hljs-attr">elementType</span>=<span class="hljs-string">"C"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"a2"</span> <span class="hljs-attr">elementType</span>=<span class="hljs-string">"C"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"a3"</span> <span class="hljs-attr">elementType</span>=<span class="hljs-string">"C"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"a4"</span> <span class="hljs-attr">elementType</span>=<span class="hljs-string">"C"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"a5"</span> <span class="hljs-attr">elementType</span>=<span class="hljs-string">"C"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"a6"</span> <span class="hljs-attr">elementType</span>=<span class="hljs-string">"H"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"a7"</span> <span class="hljs-attr">elementType</span>=<span class="hljs-string">"H"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"a8"</span> <span class="hljs-attr">elementType</span>=<span class="hljs-string">"H"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"a9"</span> <span class="hljs-attr">elementType</span>=<span class="hljs-string">"H"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"a10"</span> <span class="hljs-attr">elementType</span>=<span class="hljs-string">"H"</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">atomArray</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bondArray</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bond</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"a1_a2"</span> <span class="hljs-attr">atomRefs2</span>=<span class="hljs-string">"a1 a2/&gt;
    &lt;bond id="</span><span class="hljs-attr">a2_a3</span>" <span class="hljs-attr">atomRefs2</span>=<span class="hljs-string">"a2 a3/&gt;
    &lt;bond id="</span><span class="hljs-attr">a3_a4</span>" <span class="hljs-attr">atomRefs2</span>=<span class="hljs-string">"a3 a4/&gt;
    &lt;bond id="</span><span class="hljs-attr">a4_a5</span>" <span class="hljs-attr">atomRefs2</span>=<span class="hljs-string">"a4 a5/&gt;
    &lt;bond id="</span><span class="hljs-attr">a5_a1</span>" <span class="hljs-attr">atomRefs2</span>=<span class="hljs-string">"a5 a1/&gt;
    &lt;bond id="</span><span class="hljs-attr">a1_a6</span>" <span class="hljs-attr">atomRefs2</span>=<span class="hljs-string">"a1 a6/&gt;
    &lt;bond id="</span><span class="hljs-attr">a2_a7</span>" <span class="hljs-attr">atomRefs2</span>=<span class="hljs-string">"a2 a7/&gt;
    &lt;bond id="</span><span class="hljs-attr">a3_a8</span>" <span class="hljs-attr">atomRefs2</span>=<span class="hljs-string">"a3 a8/&gt;
    &lt;bond id="</span><span class="hljs-attr">a4_a9</span>" <span class="hljs-attr">atomRefs2</span>=<span class="hljs-string">"a4 a9/&gt;
    &lt;bond id="</span><span class="hljs-attr">a5_a10</span>" <span class="hljs-attr">atomRefs2</span>=<span class="hljs-string">"a5 a10/&gt;
  &lt;/bondArray&gt;
&lt;/molecule&gt;
</span></span></code></pre>
<p>About this representation, Peter says:</p>
<blockquote>
  <p>Note that I have not added any bond orders - this is deliberate. the community will argue about whether the ring bonds are single, double, delocalised, pi, etc. They will argue where the charge should be put. So I have added exactly enough information that stops before they start fighting.</p>
</blockquote>
<p>Leaving the pi-system undefined may be appealing as a way to prevent "fighting", but it also prevents those with informed opinions on the subject from engaging in the kind discussion that's essential for scientific progress. For example:</p>
<ul>
<li>We need to specify an overall formal charge.</li>
<li>A system or person with opinions about the "right" way to represent the pi system will have no tool with which to do so.</li>
<li>The level of ambiguity may be unacceptably high, depending on the application. For example, calculating the bond order of any of the C-C bonds would be difficult at best, and impossible if two or more Cp- units appeared in the same molecule because we can't say with which atoms the electrons giving rise to the "formal charges" are associated with.</li>
</ul>
<p>Note that this representation accomplishes the goal of making all carbon atoms equivalent without introducing inconsistencies - something that's impossible to do with most other molecular languages.</p>
<h2 id="flexmol">FlexMol</h2>
<p>Here is one way of representing cyclopentadienyl anion in FlexMol:</p>
<p><img src="/images/posts/20090413/flexmol.png" alt="FlexMol" title="FlexMol"></p>
<pre><code class="hljs xml language-xml"><span class="hljs-comment">&lt;!-- Cyclopentadienyl Anion --&gt;</span>
<span class="hljs-meta">&lt;?xml version="1.0" standalone="yes"?&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">molecule</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">constitution</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">atoms</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"C0"</span> <span class="hljs-attr">symbol</span>=<span class="hljs-string">"C"</span> <span class="hljs-attr">hydrogens</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">ionization</span>=<span class="hljs-string">"4"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">atom</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"C1"</span> <span class="hljs-attr">symbol</span>=<span class="hljs-string">"C"</span> <span class="hljs-attr">hydrogens</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">ionization</span>=<span class="hljs-string">"4"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">atom</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"C2"</span> <span class="hljs-attr">symbol</span>=<span class="hljs-string">"C"</span> <span class="hljs-attr">hydrogens</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">ionization</span>=<span class="hljs-string">"4"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">atom</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"C3"</span> <span class="hljs-attr">symbol</span>=<span class="hljs-string">"C"</span> <span class="hljs-attr">hydrogens</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">ionization</span>=<span class="hljs-string">"4"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">atom</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">atom</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"C4"</span> <span class="hljs-attr">symbol</span>=<span class="hljs-string">"C"</span> <span class="hljs-attr">hydrogens</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">ionization</span>=<span class="hljs-string">"4"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">atom</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">atoms</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bonding</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bond</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"C0"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"C1"</span> <span class="hljs-attr">bondingElectrons</span>=<span class="hljs-string">"2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bond</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bond</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"C1"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"C2"</span> <span class="hljs-attr">bondingElectrons</span>=<span class="hljs-string">"2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bond</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bond</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"C2"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"C3"</span> <span class="hljs-attr">bondingElectrons</span>=<span class="hljs-string">"2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bond</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bond</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"C3"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"C4"</span> <span class="hljs-attr">bondingElectrons</span>=<span class="hljs-string">"2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bond</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bond</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"C0"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"C4"</span> <span class="hljs-attr">bondingElectrons</span>=<span class="hljs-string">"2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bond</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">bondingSystem</span> <span class="hljs-attr">bondingElectrons</span>=<span class="hljs-string">"6"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">connections</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">atomPair</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"C0"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"C1"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">atomPair</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">atomPair</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"C1"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"C2"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">atomPair</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">atomPair</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"C2"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"C3"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">atomPair</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">atomPair</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"C3"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"C4"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">atomPair</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">atomPair</span> <span class="hljs-attr">source</span>=<span class="hljs-string">"C0"</span> <span class="hljs-attr">target</span>=<span class="hljs-string">"C4"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">atomPair</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">connections</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">bondingSystem</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bonding</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">constitution</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">molecule</span>&gt;</span>
</code></pre>
<p>This example demonstrates explicit notation not just for hydrogen atoms, but for electron counts on atoms and in bonding systems. Additional points include:</p>
<ul>
<li>We specify no overall formal charge, but can deduce it with simple electron counting rules.</li>
<li>No bond orders have been specified, yet they can be calculated using simple electron counting rules.</li>
<li>The sigma bonding framework is represented much as in CML with the shortcut <code>bond</code> element, but with the difference that we must explicitly state how many electrons are involved.</li>
<li>Simple 2-electron C-H bonds can be represented as attributes of the carbon atoms.</li>
<li>All carbon atoms are equivalent.</li>
<li>We can explicitly represent the pi system as a five-atom, six-electron <code>bondingSystem</code>. We could use the same approach to <a href="/articles/2006/12/20/a-molecular-language-for-modern-chemistry-getting-started-with-flexmol">represent benzene</a> with a six-electron, six-atom <code>bondingSystem</code>, eliminating all need for the problematic "aromatic" bond flag used in other languages.</li>
<li>We could alternatively make a 1-1 correspondence between Hueckel molecular orbitals and <code>bondingSystems</code>, creating five five-atom <code>bondingSystems</code>, three of which would contain two electrons, and two of which would contain zero electrons.</li>
<li>Whether we use one <code>bondingSystem</code> or five to model the pi-system, we'll arrive at the same result for bond order and formal charge calculations.</li>
<li>In exchange for more expressive power, we may have a more verbose representation than the CML approach.</li>
</ul>
<p>The most important point about the <code>bondingSystem</code> element is that it separates the important concepts of connectivity (<code>atomPair</code>) from bonding. This is a key point that distinguishes FlexMol from all other molecular languages that I'm aware of, and it's a subject we'll return to in subsequent articles.</p>
<h2 id="conclusions">Conclusions</h2>
<p>Although we haven't yet gotten to ferrocene, we've seen some big differences between CML and FlexMol even at the level of cyclopentadienyl anion. I'd suggest that FlexMol offers a more expressive palette, but at the expense of being a bit more verbose. The utility of that additional expressiveness depends on the problem at hand.</p>
    </article>

      </div>
    </main>
    <footer>
      <ul>
        <li>&copy; 2006-2023<li><a href="https://creativecommons.org/licenses/by/2.0/">CC-BY</a></li><li><a href="/about/">Richard L. Apodaca</a></li><li><a href="/articles.atom">Feed</a></li>
      </ul>
    </footer>
    <script src="/js/moment.js"></script>
    <script src="/js/timestamps.js"></script>
    <script src="/js/analytics.js"></script>
  </body>
</html>