<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Reading and Translating ChemDraw CDX Files with OpenBabel | Depth-First</title>
    <link rel="alternate" href="/articles.atom" title="Depth-First" type="application/atom+xml">
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/global.css">
    <link rel="shortcut icon" href="/images/favicon.png">
    <link rel="me" href="https://fosstodon.org/@rapodaca">
        <link rel="stylesheet" href="/css/document.css">
    <link rel="stylesheet" href="/css/syntax.css">
    <link rel="stylesheet" href="/css/article.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">

  </head>
  <body>
    <header>
      <div class="wrapper">
        <div class="site-id"><a href="/">Depth-First</a></div>
        <nav>
          <ul>
            <li><a href="/articles/">Archive</a></li><li><a href="/about/">About</a></li>
          </ul>
        </nav>
      </div>
    </header>
    <main>
      <div class="wrapper">
            <article>
      <header>
        <h1>Reading and Translating ChemDraw CDX Files with OpenBabel</h1>
        <p class="byline">By Richard L. Apodaca</p>
          <time datetime="2010-09-17T00:00:00.000Z">2010-09-17T00:00:00.000Z</time>
      </header>
      <p>The previous article in this series gave a brief <a href="/articles/2010/09/13/a-brief-introduction-to-the-chemdraw-cdx-file-format">introduction to the ChemDraw CDX file format</a>. It also described the important role this file format plays in the business and science of chemistry. Given the ubiquity of CDX files, how can we read them in an inexpensive way? This article describes one approach that uses <a href="http://openbabel.org/wiki/Main_Page">Open Babel</a>.</p>
<h2 id="getopenbabel">Get Open Babel</h2>
<p>Open Babel is both a command line utility and a developer toolkit. In this tutorial, we'll be using the command line utility to read CDX files generated by a drawing program. If you haven't done so already, <a href="http://openbabel.org/wiki/Get_Open_Babel">install Open Babel on your system</a>. I'm running MacPorts, so it was this simple:</p>
<pre><code class="hljs bash language-bash">sudo port install openbabel
</code></pre>
<h2 id="getsomecdxfiles">Get Some CDX Files</h2>
<p>Now we'll need to make some CDX files. If you're fortunate enough to already have access to ChemDraw, you're all set. If not, you have a couple of options:</p>
<ol>
<li>Download a free 2-week <a href="http://scistore.cambridgesoft.com/ScistoreSoftwareDisplay.aspx?Trial=Trial">evaluation copy of ChemDraw</a>. I'm not sure if CDX writing is supported in the evaluation version. After taking the time to download it, the installer looked sufficiently non-standard on my Mac to make me re-think letting this software loose on my system.</li>
<li><a href="http://www.chemdoodle.com/">Buy a license to Chemdoodle</a>. Chemdoodle is a full-featured desktop chemical drawing package. Unfortunately, the 30-day free trial does not support writing CDX files. It does, however, read CDX files quite nicely.</li>
<li><a href="http://www.chemaxon.com/marvin/sketch/index.php">Use the Marvin online demo</a>. Free to use with no installation required.</li>
</ol>
<p>In the interest of time and money, I decided to go with Option (3) for now. To save even more time, you can <a href="http://github.com/metamolecular/fugu">download the files I created</a>.</p>
<h2 id="gettranslating">Get Translating</h2>
<p>With a selection of CDX files in hand, we can now convert them. Change into the directory containing the CDX files. If you downloaded the examples, you might use:</p>
<pre><code class="hljs bash language-bash">babel -icdx benzene.cdx -omol benzene.mol
</code></pre>
<p>This generates a properly formatted molfile:</p>
<pre><code class="hljs bash language-bash">benzene.cdx
 OpenBabel09171008482D

  6  6  0  0  0  0  0  0  0  0999 V2000
   34.4702  -47.1348    0.0000 C   0  0  0  0  0
   31.0649  -49.1009    0.0000 C   0  0  0  0  0
   31.0649  -53.0331    0.0000 C   0  0  0  0  0
   34.4702  -54.9993    0.0000 C   0  0  0  0  0
   37.8756  -53.0331    0.0000 C   0  0  0  0  0
   37.8756  -49.1009    0.0000 C   0  0  0  0  0
  1  2  1  0  0  0
  1  6  2  0  0  0
  2  3  2  0  0  0
  3  4  1  0  0  0
  4  5  2  0  0  0
  5  6  1  0  0  0
M  END
</code></pre>
<p>Now let's try converting a reaction:</p>
<p><img src="/images/posts/20100917/reaction.png" alt="Reaction" title="Reaction"></p>
<pre><code class="hljs bash language-bash">babel -icdx benzene-to-aniline-reaction.cdx -omol benzene-to-aniline-reaction.mol    
</code></pre>
<p>The output is an SD file in which the first molecule is benzene and the second is aniline:</p>
<pre><code class="hljs bash language-bash">benzene-to-aniline-reaction.cdx
 OpenBabel09171008512D

  6  6  0  0  0  0  0  0  0  0999 V2000
   19.7159  -48.6707    0.0000 C   0  0  0  0  0
   16.3106  -50.6368    0.0000 C   0  0  0  0  0
   16.3106  -54.5691    0.0000 C   0  0  0  0  0
   19.7159  -56.5352    0.0000 C   0  0  0  0  0
   23.1212  -54.5691    0.0000 C   0  0  0  0  0
   23.1212  -50.6368    0.0000 C   0  0  0  0  0
  1  2  1  0  0  0
  1  6  2  0  0  0
  2  3  2  0  0  0
  3  4  1  0  0  0
  4  5  2  0  0  0
  5  6  1  0  0  0
M  END
$$$$
benzene-to-aniline-reaction.cdx
 OpenBabel09171008512D

  7  7  0  0  0  0  0  0  0  0999 V2000
   47.6623  -48.6707    0.0000 C   0  0  0  0  0
   44.2570  -50.6368    0.0000 C   0  0  0  0  0
   44.2570  -54.5691    0.0000 C   0  0  0  0  0
   47.6623  -56.5352    0.0000 C   0  0  0  0  0
   51.0676  -54.5691    0.0000 C   0  0  0  0  0
   51.0676  -50.6368    0.0000 C   0  0  0  0  0
   54.4730  -48.6707    0.0000 N   0  0  0  0  0
  1  2  1  0  0  0
  1  6  2  0  0  0
  2  3  2  0  0  0
  3  4  1  0  0  0
  4  5  2  0  0  0
  5  6  1  0  0  0
  6  7  1  0  0  0
M  END
</code></pre>
<p>Notice how information has been lost (the reaction arrow and text) in this conversion due in part to impedance mismatch between the CDX format and the molfile format.</p>
<h2 id="wrapup">Wrapup</h2>
<p>Open Babel can read and convert a subset of the ChemDraw CDX file format. But what if we wanted to do more? Future articles will offer some ideas.</p>
    </article>
      <div id="disqus_thread"></div>
      <script src="/js/comments.js"></script>

      </div>
    </main>
    <footer>
      <ul>
        <li>&copy; 2006-2024<li><a href="https://creativecommons.org/licenses/by/2.0/">CC-BY</a></li><li><a href="/about/">Richard L. Apodaca</a></li><li><a href="/articles.atom">Feed</a></li>
      </ul>
    </footer>
    <script src="/js/moment.js"></script>
    <script src="/js/timestamps.js"></script>
    <script src="/js/analytics.js"></script>
  </body>
</html>